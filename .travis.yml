language: python
dist: xenial
matrix:
  include:
    - python: '3.5'
    - python: '3.6'
    - python: '3.7'


before_script:
  # For now we have to make install libecl.
  # Remove when it's possible to pip install

  - source .libecl_version
  - git clone https://github.com/equinor/libecl
  - pushd libecl
  - git fetch
  - git checkout tags/$LIBECL_VERSION
  - pip install -r requirements.txt
  - mkdir build
  - pushd build
  - cmake .. -DENABLE_PYTHON=ON
             -DBUILD_APPLICATIONS=ON
             -DINSTALL_CWRAP=OFF
             -DCMAKE_INSTALL_PREFIX=$INSTALL_DIR
             -DCMAKE_PREFIX_PATH=$INSTALL_DIR
             -DCMAKE_C_FLAGS='-Werror=all'
             -DCMAKE_CXX_FLAGS='-Werror -Wno-unused-result'
  - make
  - make install
  - popd;popd

before_install:
  - python3 --version

install:
  - python3 -m pip install --upgrade pip
  - python3 -m pip install --upgrade -r requirements-dev.txt

script:
  - python3 setup.py test
  - python3 -m flake8 subscript


